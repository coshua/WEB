### Stateful vs. Stateless
Stateful 서버는 클라이언트의 상태를 계속해서 유지하고, 이 정보를 클라이언트에서 들어오는 요청을 처리할때 이용한다. 대표적으로 세션을 이용한 웹 서버가 있다.
세션은 클라이언트에서 들어온 인증, 기록을 서버에 저장하는 것을 말한다.
서버의 데이터베이스나나 메모리에 유저의 로그인 정보를 저장해두는 것이 세션 활용의 한 예이다. 로그인 되어있다는 상태, 즉 State 를 서버 측에 저장하기 때문에 stateful 하다.
클라이언트에서 권한이 필요한 요청을 보내면 서버는 세션 저장소에서 세션의 상태를 읽고 적절한 작업을 수행한다. 많은 요청과 세션이 있다면 서버에서 처리하는 작업에 과부하가 갈 것이다.
반대로 stateless 서버에는 상태가 없다. 오직 클라이언트에서 들어오는 요청만으로 작업을 처리한다.

### 토큰
Stateless 서버를 위해 토큰 기반 시스템을 이용한다. 상태, 즉 세션이 필요하지 않다는 얘기는 곧 서버가 사용자의 인증 여부를 더이상 서버에 저장하지 않는단 얘기이다.
그렇다면 어떻게 사용자의 로그인 상태를 관리할까? 서버는 사용자에게 토큰을 발급하여 클라이언트의 로컬에 저장시키고, 사용자는 요청할때 토큰 정보(적절하게 로그인되어 있는지, 
특정한 권한이 있는지 등)를 요청 사항과 함께 전달한다.
간략하게 비유하자면 세션이 놀이공원에서 각각 이용자들의 정보를 서버의 세션 저장소에 조회해서 적절한 이용자인지 판단하는 방식이고, 
토큰은 이용자에게 통행권을 한 장 주고 이후에 그 통행권의 유효성만 검사하는 방식이다.

### JWT란?
Json Wen Token 은 속성 정보를 JSON 데이터 구조로 표현한 토큰이다. 이 JSON 형태는 URL로 들어갈 수 있는 문자로만 구성되어 있으며 전자 서명을 포함하고 있어 토큰이 변조되었는지 확인할 수 있다.
클라이언트의 리퀘스트 헤더에 JWT 를 넣고 서버로 요청하면 서버는 JWT 정보를 통해 인증한다. 필요시 url 파라미터로도 전달이 가능하다.

### JWT의 구성
JWT 는 세 파트로 나누어지며 firstpart.secondpart.thirdpart 이런 식으로 문자 . 으로 각 파트가 구분된다. 순서대로 header, payload, signature 정보를 담고 있다.

### 흐름
사용자 로그인 인증이 JWT로 어떻게 이루어지는지 살펴보자.

1. 사용자가 id, password 를 입력하고 로그인 시도를 한다.
2. 서버에 요청이 날아가고 해당 정보가 서버에 있다면 Access token 을 발급한다.
3. Token 을 클라이언트에 전달한다.
4. 클라이언트에서 api를 요청할때 header 부분에 token 을 담아서 request 한다.
5. 서버는 JWT signature 를 확인하여 유효한 토큰인지 검증하고 payload 에 담겨있는 사용자 정보에 기반하여 데이터를 반환한다.

### 장단점
장점
* 서버에서 유저의 세션을 유지할 필요가 없다. 들어오는 요청에 대해 유효한 토큰인지 확인만 하면 되므로 서버 자원 관리에 유리하다.
* 처음 토큰을 발급할때 만료 기간을 설정해줄 수 있다.

단점
* 담는 정보가 많아질수록 토큰의 길이가 길어져 비효율적일 수 있다.

